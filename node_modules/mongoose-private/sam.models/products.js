'use strict';

var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var privatePaths = require('../lib');
//var privatePaths = require('mongoose-private-paths');

var HistoricalInfoSchema = new Schema({
  dateFrom: {
    type: Date,
    'default': Date.now,
    private: true
  },
  dateTo: {
    type: Date,
    'default': Date.now
  },
  weight: Number,
  hasCallbacks: Boolean
});

var ProductRatesHistorySchema = new Schema({
  rateTypeNumber: Number, //0 == ?, 1 == reducing, 2 == flat, 3 == combination, -1 == ?
  isPercentage: Boolean,
  rateType: String,
  serialNo: Number,
  rateDate: Date,
  rate: Number
});

var ProductSchema = new Schema({
  type: { //credit card, personal loan, etc.
    type: String,
    required: true
  },
  nested: [HistoricalInfoSchema],
  obj: {
    obj1: {type: String, private: true},
    obj2: {type: String, private: true},
    obj3: {type: String, private: true}
  },
  arrS: [{type: String, private: true}],
  arrO: [{obj2: {type: String, private: true}}],
  'is.it.possible': {type: String, private: true}
});

ProductSchema.plugin(privatePaths);
mongoose.model('Products', ProductSchema, 'products');